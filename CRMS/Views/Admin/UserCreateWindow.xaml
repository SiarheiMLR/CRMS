<metro:MetroWindow x:Class="CRMS.Views.Admin.UserCreateWindow"
                   xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                   xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                   xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
                   xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
                   xmlns:local="clr-namespace:CRMS.Views.Admin"
                   xmlns:converters="clr-namespace:CRMS.Infrastructure.Converters"
                   xmlns:domain="clr-namespace:CRMS.Domain.Entities;assembly=CRMS.Domain"
                   xmlns:sys="clr-namespace:System;assembly=mscorlib"
                   xmlns:metro="http://metro.mahapps.com/winfx/xaml/controls"
                   xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
                   mc:Ignorable="d"
                   Title="Создание нового пользователя"
                   Height="500" Width="800"
                   WindowStartupLocation="CenterScreen">

    <metro:MetroWindow.Resources>
        <converters:ByteArrayToImageConverter x:Key="AvatarConverter"/>
        <converters:NullToTextConverter x:Key="NullToTextConverter" NullText="Не указано" DateTimeFormat="dd.MM.yyyy HH:mm:ss"/>
        <converters:BoolToTextConverter x:Key="BoolToTextConverter" TrueText="Да" FalseText="Нет"/>
        <converters:RoleFromGroupsConverter x:Key="RoleFromGroupsConverter"/>
        <converters:InverseBooleanConverter x:Key="InverseBool"/>
        <converters:UserRoleToGroupLabelConverter x:Key="UserRoleToGroupLabelConverter"/>
        <converters:BoolToVisibilityConverter x:Key="BoolToVisibilityConverter"/>
        <converters:InverseBoolToVisibilityConverter x:Key="InverseBoolToVisibility"/>
        <converters:UserStatusToRussianConverter x:Key="UserStatusToRussianConverter"/>

        <ObjectDataProvider x:Key="UserStatusValues"
                    MethodName="GetValues"
                    ObjectType="{x:Type sys:Enum}">
            <ObjectDataProvider.MethodParameters>
                <x:Type TypeName="domain:UserStatus"/>
            </ObjectDataProvider.MethodParameters>
        </ObjectDataProvider>

        <LinearGradientBrush x:Key="BackgroundGradient" StartPoint="0,0" EndPoint="1,1">
            <GradientStop Color="#FF6C5B7B" Offset="0"/>
            <GradientStop Color="#FFC06C84" Offset="0.5"/>
            <GradientStop Color="#FF355C7D" Offset="1"/>
        </LinearGradientBrush>

        <Style TargetType="GroupBox">
            <Setter Property="Margin" Value="5"/>
            <Setter Property="Padding" Value="5"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="BorderBrush" Value="#FFCCCCCC"/>
        </Style>

        <Style TargetType="TextBlock">
            <Setter Property="Margin" Value="2,5"/>
        </Style>

        <Style TargetType="TabItem">
            <Setter Property="Padding" Value="8,4"/>
        </Style>
    </metro:MetroWindow.Resources>

    <materialDesign:DialogHost Identifier="EditDeleteGroupDialogHost">
        <Grid>
            <Border Background="{StaticResource BackgroundGradient}"/>
            <Grid Margin="10">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- Заголовок с фото -->
                <Grid Grid.Row="0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <Button Width="130" Height="130"
                            VerticalAlignment="Top" HorizontalAlignment="Left"
                            Background="Transparent"
                            BorderBrush="{x:Null}"
                            Padding="0"
                            Command="{Binding SelectAvatarCommand}">
                        <Image Source="{Binding EditableUser.Avatar, Converter={StaticResource AvatarConverter}}"
                               Width="100" Height="100">
                            <Image.Style>
                                <Style TargetType="Image">
                                    <Setter Property="Source" Value="{Binding EditableUser.Avatar, Converter={StaticResource AvatarConverter}}"/>
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding EditableUser.Avatar}" Value="{x:Null}">
                                            <Setter Property="Source" Value="/CRMS;component/Resources/Images/no-avatar.jpg"/>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </Image.Style>
                        </Image>
                    </Button>

                    <StackPanel Grid.Column="1" Margin="10,0,0,0" VerticalAlignment="Center">
                        <TextBox Text="{Binding EditableUser.DisplayName, UpdateSourceTrigger=PropertyChanged}"
                                 Style="{StaticResource MaterialDesignFloatingHintTextBox}"
                                 materialDesign:HintAssist.Hint="Отображаемое имя"
                                 FontSize="20" FontWeight="Bold"/>
                        <TextBox Text="{Binding EditableUser.JobTitle, UpdateSourceTrigger=PropertyChanged}"
                                 Style="{StaticResource MaterialDesignFloatingHintTextBox}"
                                 materialDesign:HintAssist.Hint="Должность"
                                 FontStyle="Italic" Foreground="Black"/>
                    </StackPanel>
                </Grid>

                <!-- Основная информация с вкладками -->
                <TabControl Grid.Row="1" Margin="0,10,0,10" Padding="0">
                    <TabItem Header="Общие" Background="#FFFBEEC1">
                        <StackPanel Margin="0,0,0,-29">
                            <!-- Основная информация -->
                            <GroupBox Header="Основная информация" Height="223">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="20"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>

                                    <TextBlock Grid.Row="0" Grid.Column="0" Text="Имя:" FontWeight="Bold" Margin="0,10,10,0"/>
                                    <TextBox Grid.Row="0" Grid.Column="1"
                                             Text="{Binding EditableUser.FirstName, UpdateSourceTrigger=PropertyChanged}"
                                             Style="{StaticResource MaterialDesignFloatingHintTextBox}"
                                             materialDesign:HintAssist.Hint="Введите имя пользователя"/>

                                    <TextBlock Grid.Row="0" Grid.Column="3" Text="Инициалы:" FontWeight="Bold" Margin="0,10,10,0"/>
                                    <TextBox Grid.Row="0" Grid.Column="4"
                                             Text="{Binding EditableUser.Initials, UpdateSourceTrigger=PropertyChanged}"
                                             Style="{StaticResource MaterialDesignFloatingHintTextBox}"
                                             materialDesign:HintAssist.Hint="Введите инициалы пользователя"/>

                                    <TextBlock Grid.Row="1" Grid.Column="0" Text="Фамилия:" FontWeight="Bold" Margin="0,10,10,0"/>
                                    <TextBox Grid.Row="1" Grid.Column="1"
                                             Text="{Binding EditableUser.LastName, UpdateSourceTrigger=PropertyChanged}"
                                             Style="{StaticResource MaterialDesignFloatingHintTextBox}"
                                             materialDesign:HintAssist.Hint="Введите фамилию пользователя"/>

                                    <TextBlock Grid.Row="1" Grid.Column="3" Text="День рождения:" FontWeight="Bold" Margin="0,10,10,0"/>
                                    <DatePicker Grid.Row="1" Grid.Column="4"
                                                SelectedDate="{Binding EditableUser.DateOfBirth, UpdateSourceTrigger=PropertyChanged}"
                                                SelectedDateFormat="Short"
                                                Margin="0"
                                                Style="{StaticResource MaterialDesignFloatingHintDatePicker}"
                                                materialDesign:HintAssist.Hint="Введите дату рождения пользователя"/>

                                    <TextBlock Grid.Row="2" Grid.Column="0" Text="Описание:" FontWeight="Bold" Margin="0,10,10,0"/>
                                    <TextBox Grid.Row="2" Grid.Column="1" Grid.ColumnSpan="4"
                                             Text="{Binding EditableUser.Description, UpdateSourceTrigger=PropertyChanged}"
                                             TextWrapping="Wrap"
                                             Margin="0,0,0,10"
                                             Style="{StaticResource MaterialDesignFloatingHintTextBox}"
                                             materialDesign:HintAssist.Hint="Введите описание пользователя"/>

                                    <TextBlock Grid.Row="3" Grid.Column="0" Text="Офис:" FontWeight="Bold" Margin="0,10,10,0"/>
                                    <TextBox Grid.Row="3" Grid.Column="1"
                                             Text="{Binding EditableUser.Office, UpdateSourceTrigger=PropertyChanged}"
                                             Style="{StaticResource MaterialDesignFloatingHintTextBox}"
                                             materialDesign:HintAssist.Hint="Введите офис пользователя"/>

                                    <TextBlock Grid.Row="3" Grid.Column="3" Text="Телефон:" FontWeight="Bold" Margin="0,10,10,0"/>
                                    <TextBox Grid.Row="3" Grid.Column="4"
                                             Text="{Binding EditableUser.WorkPhone, UpdateSourceTrigger=PropertyChanged}"
                                             PreviewTextInput="OnlyPhoneChars_PreviewTextInput"
                                             DataObject.Pasting="OnlyPhoneChars_Pasting"
                                             Style="{StaticResource MaterialDesignFloatingHintTextBox}"
                                             materialDesign:HintAssist.Hint="Введите рабочий телефон пользователя"/>

                                    <TextBlock Grid.Row="4" Grid.Column="0" Text="Email:" FontWeight="Bold" Margin="0,10,10,0"/>
                                    <TextBox Grid.Row="4" Grid.Column="1"
                                             Text="{Binding EditableUser.Email, UpdateSourceTrigger=PropertyChanged}"
                                             Style="{StaticResource MaterialDesignFloatingHintTextBox}"
                                             materialDesign:HintAssist.Hint="Введите email пользователя"/>

                                    <TextBlock Grid.Row="4" Grid.Column="3" Text="Веб-страница:" FontWeight="Bold" Margin="0,10,10,0"/>
                                    <TextBox Grid.Row="4" Grid.Column="4"
                                             Text="{Binding EditableUser.WebPage, UpdateSourceTrigger=PropertyChanged}"
                                             Style="{StaticResource MaterialDesignFloatingHintTextBox}"
                                             materialDesign:HintAssist.Hint="Введите сайт пользователя"/>
                                </Grid>
                            </GroupBox>
                        </StackPanel>
                    </TabItem>

                    <TabItem Header="Адрес" Background="Azure">
                        <StackPanel Margin="0,0,0,-29">
                            <GroupBox Header="Почтовый адрес" Height="223">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>

                                    <!-- Страна -->
                                    <TextBlock Grid.Row="0" Grid.Column="0" Text="Страна:" FontWeight="Bold" Margin="0,10,10,0"/>
                                    <TextBox Grid.Row="0" Grid.Column="1"
                                             Text="{Binding EditableUser.Country, UpdateSourceTrigger=PropertyChanged}"
                                             Style="{StaticResource MaterialDesignFloatingHintTextBox}"
                                             materialDesign:HintAssist.Hint="Введите название страны"/>

                                    <!-- Область/край -->
                                    <TextBlock Grid.Row="1" Grid.Column="0" Text="Область/край:" FontWeight="Bold" Margin="0,10,10,0"/>
                                    <TextBox Grid.Row="1" Grid.Column="1"
                                             Text="{Binding EditableUser.State, UpdateSourceTrigger=PropertyChanged}"
                                             Style="{StaticResource MaterialDesignFloatingHintTextBox}"
                                             materialDesign:HintAssist.Hint="Введите наименование области"/>

                                    <!-- Город -->
                                    <TextBlock Grid.Row="2" Grid.Column="0" Text="Город:" FontWeight="Bold" Margin="0,10,10,0"/>
                                    <TextBox Grid.Row="2" Grid.Column="1"
                                             Text="{Binding EditableUser.City, UpdateSourceTrigger=PropertyChanged}"
                                             Style="{StaticResource MaterialDesignFloatingHintTextBox}"
                                             materialDesign:HintAssist.Hint="Введите название города"/>

                                    <!-- Индекс -->
                                    <TextBlock Grid.Row="3" Grid.Column="0" Text="Почтовый индекс:" FontWeight="Bold" Margin="0,10,10,0"/>
                                    <TextBox Grid.Row="3" Grid.Column="1"
                                             Text="{Binding EditableUser.PostalCode, UpdateSourceTrigger=PropertyChanged}"
                                             PreviewTextInput="OnlyDigits_PreviewTextInput"
                                             DataObject.Pasting="OnlyDigits_Pasting"
                                             Style="{StaticResource MaterialDesignFloatingHintTextBox}"
                                             materialDesign:HintAssist.Hint="Введите почтовый индекс"/>

                                    <!-- Улица -->
                                    <TextBlock Grid.Row="4" Grid.Column="0" Text="Адрес:" FontWeight="Bold" Margin="0,10,10,0"/>
                                    <TextBox Grid.Row="4" Grid.Column="1"
                                             Text="{Binding EditableUser.Street, UpdateSourceTrigger=PropertyChanged}"
                                             Style="{StaticResource MaterialDesignFloatingHintTextBox}"
                                             materialDesign:HintAssist.Hint="Введите адрес"/>
                                </Grid>
                            </GroupBox>
                        </StackPanel>
                    </TabItem>

                    <TabItem Header="Учетная запись" Background="#FFE1F5FE">
                        <StackPanel Margin="0,0,0,-29">
                            <GroupBox Header="Параметры учетной записи" Height="223">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>

                                    <TextBlock Grid.Row="0" Grid.Column="0" Text="Логин пользователя:" FontWeight="Bold" Margin="0,10,10,0"/>
                                    <TextBox Grid.Row="0" Grid.Column="1"
                                             Text="{Binding EditableUser.UserLogonName, UpdateSourceTrigger=PropertyChanged}"
                                             Style="{StaticResource MaterialDesignFloatingHintTextBox}"
                                             materialDesign:HintAssist.Hint="Введите логин пользователя"/>

                                    <TextBlock Grid.Row="1" Grid.Column="0" Text="Пароль пользователя:" FontWeight="Bold" Margin="0,10,10,0"/>
                                    <PasswordBox Grid.Row="1" Grid.Column="1"
                                                 PasswordChanged="PasswordBox_PasswordChanged"
                                                 Style="{StaticResource MaterialDesignFloatingHintPasswordBox}"
                                                 materialDesign:HintAssist.Hint="Введите пароль пользователя"
                                                 Margin="0,0,0,5"/>

                                    <TextBlock Grid.Row="2" Grid.Column="0" Text="Дата создания учетной записи:" FontWeight="Bold" Margin="0,10,10,0"/>
                                    <DatePicker Grid.Row="2" Grid.Column="1"
                                                SelectedDate="{Binding EditableUser.AccountCreated, UpdateSourceTrigger=PropertyChanged}"
                                                SelectedDateFormat="Short"
                                                Margin="0"
                                                Style="{StaticResource MaterialDesignFloatingHintDatePicker}"
                                                materialDesign:HintAssist.Hint="Дата создания"/>

                                    <TextBlock Grid.Row="3" Grid.Column="0" Text="Статус активности пользователя:" FontWeight="Bold" Margin="0,10,10,0"/>
                                    <ComboBox Grid.Row="3" Grid.Column="1"
                                              ItemsSource="{Binding Source={StaticResource UserStatusValues}}"
                                              SelectedItem="{Binding EditableUser.Status, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                              Style="{StaticResource MaterialDesignFloatingHintComboBox}"
                                              materialDesign:HintAssist.Hint="Выберите статус пользователя"
                                              materialDesign:HintAssist.IsFloating="True"
                                              VerticalContentAlignment="Center">
                                        <ComboBox.ItemTemplate>
                                            <DataTemplate>
                                                <TextBlock Text="{Binding Converter={StaticResource UserStatusToRussianConverter}}" />
                                            </DataTemplate>
                                        </ComboBox.ItemTemplate>
                                    </ComboBox>

                                    <TextBlock Grid.Row="4" Grid.Column="0" Text="Принадлежность к группе:" FontWeight="Bold" Margin="0,10,10,0"/>
                                    <ComboBox Grid.Row="4" Grid.Column="1"
                                              SelectedValue="{Binding EditableUser.Role}"
                                              Style="{StaticResource MaterialDesignFloatingHintComboBox}"
                                              materialDesign:HintAssist.Hint="Выберите группу">
                                        <ComboBoxItem Content="Пользователь" Tag="{x:Static domain:UserRole.User}"/>
                                        <ComboBoxItem Content="Поддержка" Tag="{x:Static domain:UserRole.Support}"/>
                                        <ComboBoxItem Content="Администратор" Tag="{x:Static domain:UserRole.Admin}"/>
                                    </ComboBox>
                                </Grid>
                            </GroupBox>
                        </StackPanel>
                    </TabItem>

                    <TabItem Header="Контакты" Background="#FFF3E5F5">
                        <StackPanel Margin="0,0,0,-29">
                            <GroupBox Header="Контактные данные" Height="223">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="20"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>

                                    <TextBlock Grid.Row="0" Grid.Column="0" Text="Компания:" FontWeight="Bold" Margin="0,10,10,0"/>
                                    <TextBox Grid.Row="0" Grid.Column="1"
                                             Text="{Binding EditableUser.Company, UpdateSourceTrigger=PropertyChanged}"
                                             Style="{StaticResource MaterialDesignFloatingHintTextBox}"
                                             materialDesign:HintAssist.Hint="Введите название компании"/>

                                    <TextBlock Grid.Row="0" Grid.Column="3" Text="Рабочий телефон:" FontWeight="Bold" Margin="0,10,10,0"/>
                                    <TextBox Grid.Row="0" Grid.Column="4"
                                             Text="{Binding EditableUser.WorkPhone, UpdateSourceTrigger=PropertyChanged}"
                                             PreviewTextInput="OnlyPhoneChars_PreviewTextInput"
                                             DataObject.Pasting="OnlyPhoneChars_Pasting"
                                             Style="{StaticResource MaterialDesignFloatingHintTextBox}"
                                             materialDesign:HintAssist.Hint="Введите рабочий телефон пользователя"/>

                                    <TextBlock Grid.Row="1" Grid.Column="0" Text="Отдел:" FontWeight="Bold" Margin="0,10,10,0"/>
                                    <TextBox Grid.Row="1" Grid.Column="1"
                                             Text="{Binding EditableUser.Department, UpdateSourceTrigger=PropertyChanged}"
                                             Style="{StaticResource MaterialDesignFloatingHintTextBox}"
                                             materialDesign:HintAssist.Hint="Введите наименование отдела"/>

                                    <TextBlock Grid.Row="1" Grid.Column="3" Text="Мобильный телефон:" FontWeight="Bold" Margin="0,10,10,0"/>
                                    <TextBox Grid.Row="1" Grid.Column="4"
                                             Text="{Binding EditableUser.MobilePhone, UpdateSourceTrigger=PropertyChanged}"
                                             PreviewTextInput="PhoneTextBox_PreviewTextInput"
                                             TextChanged="PhoneTextBox_TextChanged"
                                             MaxLength="19"
                                             Style="{StaticResource MaterialDesignFloatingHintTextBox}"
                                             materialDesign:HintAssist.Hint="Введите мобильный телефон пользователя"/>

                                    <TextBlock Grid.Row="2" Grid.Column="0" Text="Менеджер:" FontWeight="Bold" Margin="0,10,10,0"/>
                                    <TextBox Grid.Row="2" Grid.Column="1"
                                             Text="{Binding EditableUser.ManagerName, UpdateSourceTrigger=PropertyChanged}"
                                             Style="{StaticResource MaterialDesignFloatingHintTextBox}"
                                             materialDesign:HintAssist.Hint="Введите email менеджера"/>

                                    <TextBlock Grid.Row="2" Grid.Column="3" Text="IP-телефон:" FontWeight="Bold" Margin="0,10,10,0"/>
                                    <TextBox Grid.Row="2" Grid.Column="4"
                                             Text="{Binding EditableUser.IPPhone, UpdateSourceTrigger=PropertyChanged}"
                                             Style="{StaticResource MaterialDesignFloatingHintTextBox}"
                                             materialDesign:HintAssist.Hint="Введите IP-телефон пользователя"/>
                                </Grid>
                            </GroupBox>
                        </StackPanel>
                    </TabItem>
                </TabControl>

                <StackPanel Grid.Row="2"
                            Orientation="Horizontal"
                            HorizontalAlignment="Stretch"
                            Margin="10,10,10,5">

                    <!-- Левая часть: Удалить / Редактировать -->
                    <!--<StackPanel Orientation="Horizontal"
                                HorizontalAlignment="Left"
                                VerticalAlignment="Bottom">

                        <Button Content="Удалить пользователя"
                                Width="Auto"
                                Height="35"
                                Command="{Binding DeleteCommand}"
                                Style="{StaticResource MahApps.Styles.Button}"
                                Background="IndianRed"
                                Foreground="White"
                                Margin="5"
                                Visibility="Collapsed"/>

                        <Button Content="Редактировать пользователя"
                                Width="Auto"
                                Height="35"
                                Command="{Binding EditCommand}"
                                Style="{StaticResource MahApps.Styles.Button}"
                                Background="{DynamicResource PrimaryHueMidBrush}"
                                Foreground="White"
                                Margin="5"
                                Visibility="Collapsed"/>
                    </StackPanel>-->

                    <!-- Правая часть: ОК / Отмена / Сохранить -->
                    <StackPanel Orientation="Horizontal"
                                HorizontalAlignment="Right"
                                VerticalAlignment="Bottom"
                                Margin="430,0,0,0">
                        <Button Content="ОК"
                                Width="100"
                                Height="35"
                                Command="{Binding OkCommand}"
                                Style="{StaticResource MahApps.Styles.Button}"
                                Background="{DynamicResource PrimaryHueMidBrush}"
                                Foreground="White"
                                Margin="5"/>

                        <Button Content="Отменить"
                                Width="100"
                                Height="35"
                                Command="{Binding CancelCommand}"
                                IsEnabled="{Binding HasChanges}"
                                Style="{StaticResource MahApps.Styles.Button}"
                                Background="{DynamicResource PrimaryHueMidBrush}"
                                Foreground="White"
                                Margin="5"/>

                        <Button Content="Сохранить"
                                Width="100"
                                Height="35"
                                Command="{Binding SaveCommand}"
                                IsEnabled="{Binding HasChanges}"
                                Style="{StaticResource MahApps.Styles.Button}"
                                Background="{DynamicResource PrimaryHueMidBrush}"
                                Foreground="White"
                                Margin="5"/>
                    </StackPanel>
                </StackPanel>
            </Grid>
        </Grid>
    </materialDesign:DialogHost>
</metro:MetroWindow>

